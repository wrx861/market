# Market Auto Parts - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Ubuntu 20.04 / 22.04 –∏–ª–∏ Debian 11/12
- Root –¥–æ—Å—Ç—É–ø
- –ú–∏–Ω–∏–º—É–º 2GB RAM
- –ú–∏–Ω–∏–º—É–º 20GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
- –î–æ–º–µ–Ω —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ DNS –∑–∞–ø–∏—Å—è–º–∏ (A –∑–∞–ø–∏—Å—å –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞)

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —á–∏—Å—Ç—ã–π —Å–µ—Ä–≤–µ—Ä

–î–ª—è **–Ω–æ–≤–æ–≥–æ —á–∏—Å—Ç–æ–≥–æ** Ubuntu/Debian —Å–µ—Ä–≤–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç. –û–Ω —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Docker, Docker Compose, Certbot) –∏ —Ä–∞–∑–≤–µ—Ä–Ω–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

```bash
# –°–∫–∞—á–∞—Ç—å —Å–∫—Ä–∏–ø—Ç
wget https://raw.githubusercontent.com/wrx861/market/clean-main/deployment/install-clean-server.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É
sudo bash install-clean-server.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ root
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ –ø–æ—Ä—Ç—ã (8001, 3001, 27017)
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker –∏ Docker Compose
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Certbot –¥–ª—è SSL
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- ‚úÖ –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç API –∫–ª—é—á–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ
- ‚úÖ –°–∫–∞—á–∏–≤–∞–µ—Ç –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å GitHub
- ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —á–µ—Ä–µ–∑ Let's Encrypt
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º —Å–µ—Ä–≤–µ—Ä–µ

–ï—Å–ª–∏ Docker –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã, –∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```bash
# –°–∫–∞—á–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
wget https://raw.githubusercontent.com/wrx861/market/clean-main/deployment/install.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
sudo bash install.sh
```

## üîë –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ API –∫–ª—é—á–∏

–ü–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–∏:

### 1. Telegram Bot
- `TELEGRAM_BOT_TOKEN` - —Ç–æ–∫–µ–Ω –æ—Ç @BotFather
- `TELEGRAM_ADMIN_ID` - –≤–∞—à Telegram ID (–ø–æ–ª—É—á–∏—Ç—å —É @userinfobot)

### 2. Google AI Studio (Gemini)
- `GOOGLE_API_KEY` - –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ https://makersuite.google.com/app/apikey

### 3. Rossko API (–ø–æ—Å—Ç–∞–≤—â–∏–∫ –∑–∞–ø—á–∞—Å—Ç–µ–π)
- `ROSSKO_API_KEY1` - –ø–µ—Ä–≤—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞
- `ROSSKO_API_KEY2` - –≤—Ç–æ—Ä–æ–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: https://www.rossko.ru/

### 4. Autotrade API (–ø–æ—Å—Ç–∞–≤—â–∏–∫ –∑–∞–ø—á–∞—Å—Ç–µ–π)
- `AUTOTRADE_LOGIN` - email –¥–ª—è –≤—Ö–æ–¥–∞
- `AUTOTRADE_PASSWORD` - –ø–∞—Ä–æ–ª—å
- `AUTOTRADE_API_KEY` - API –∫–ª—é—á
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: https://api2.autotrade.su/

### 5. PartsAPI.ru (–ø–æ–∏—Å–∫ –ø–æ VIN)
- `PARTSAPI_KEY` - API –∫–ª—é—á
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: https://partsapi.ru/

### 6. OpenAI API (AI –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)
- `OPENAI_API_KEY` - API –∫–ª—é—á OpenAI
- –ü–æ–ª—É—á–∏—Ç—å: https://platform.openai.com/api-keys

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```
/opt/market-auto-parts/
‚îú‚îÄ‚îÄ docker-compose.yml          # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile             # –°–±–æ—Ä–∫–∞ backend
‚îÇ   ‚îú‚îÄ‚îÄ .env                   # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è backend
‚îÇ   ‚îú‚îÄ‚îÄ server.py              # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # Pydantic –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt       # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ ...                    # –û—Å—Ç–∞–ª—å–Ω—ã–µ Python –º–æ–¥—É–ª–∏
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile             # –°–±–æ—Ä–∫–∞ frontend
‚îÇ   ‚îú‚îÄ‚îÄ .env                   # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è frontend
‚îÇ   ‚îú‚îÄ‚îÄ package.json           # Node.js –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ src/                   # React –∏—Å—Ö–æ–¥–Ω–∏–∫–∏
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îî‚îÄ‚îÄ nginx.conf             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îú‚îÄ‚îÄ ssl/
‚îÇ   ‚îú‚îÄ‚îÄ fullchain.pem          # SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
‚îÇ   ‚îî‚îÄ‚îÄ privkey.pem            # –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
‚îî‚îÄ‚îÄ mongodb/
    ‚îî‚îÄ‚îÄ data/                  # –î–∞–Ω–Ω—ã–µ MongoDB
```

## üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
cd /opt/market-auto-parts
docker-compose ps
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# Backend –ª–æ–≥–∏
docker-compose logs -f backend

# Frontend –ª–æ–≥–∏
docker-compose logs -f frontend

# –í—Å–µ –ª–æ–≥–∏
docker-compose logs -f
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ
docker-compose restart

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ backend
docker-compose restart backend

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ frontend
docker-compose restart frontend
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose up -d

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å (–ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞)
docker-compose up --build -d
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd /opt/market-auto-parts

# –°–∫–∞—á–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ (–∑–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª—ã –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ git)
# –ó–∞—Ç–µ–º –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
docker-compose up --build -d
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (cron –∑–∞–¥–∞—á–∞)
- ‚úÖ –í—Å–µ API –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ .env —Ñ–∞–π–ª–∞—Ö (–Ω–µ –≤ Git)
- ‚úÖ Backend –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Nginx reverse proxy
- ‚úÖ MongoDB –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏

## üêõ –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–æ–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç –ø–æ—Ä—Ç
sudo ss -tulpn | grep :8001
sudo ss -tulpn | grep :3001
sudo ss -tulpn | grep :27017

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ docker-compose –ø—Ä–æ–µ–∫—Ç—ã
docker ps -a
docker stop <container_id>
```

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å –ø–æ–ª–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
docker-compose logs --tail=100 backend

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env —Ñ–∞–π–ª
cat /opt/market-auto-parts/backend/.env

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Playwright —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
docker-compose exec backend playwright --version
```

### Frontend –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–±–æ—Ä–∫–∏
docker-compose logs --tail=100 frontend

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env —Ñ–∞–π–ª
cat /opt/market-auto-parts/frontend/.env
```

### SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –ø–æ–ª—É—á–µ–Ω

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–æ–º–µ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
dig miniapp.shopmarketbot.ru

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ—Ä—Ç 80 –æ—Ç–∫—Ä—ã—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ
sudo ufw allow 80

# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤—Ä—É—á–Ω—É—é
sudo certbot certonly --standalone -d miniapp.shopmarketbot.ru
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ API –∫–ª—é—á–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–º–µ–Ω–∞
4. –û—Ç–∫—Ä–æ–π—Ç–µ issue –Ω–∞ GitHub: https://github.com/wrx861/market/issues

## üîÑ –ü–æ—Ä—Ç—ã

- `80` - HTTP (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ HTTPS)
- `443` - HTTPS (Nginx)
- `8001` - Backend (–≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏)
- `3001` - Frontend (–≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏)
- `27017` - MongoDB (–≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏)

**–í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø:** —Ç–æ–ª—å–∫–æ 80 –∏ 443 –ø–æ—Ä—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã –≤ firewall.
