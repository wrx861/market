# üè¢ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –≥–∞–π–¥ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Market Auto Parts –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –≥–¥–µ **—É–∂–µ —Ä–∞–±–æ—Ç–∞—é—Ç –¥—Ä—É–≥–∏–µ –ø—Ä–æ–µ–∫—Ç—ã** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—Ä—É–≥–∏–µ —Å–∞–π—Ç—ã, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö).

## üéØ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

–°–∫—Ä–∏–ø—Ç `install-existing-server.sh` —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ –∑–∞–Ω—è—Ç—ã–µ —Å–µ—Ä–≤–µ—Ä—ã:

### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ –ø–æ—Ä—Ç—ã
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤** - –Ω–µ —É–¥–∞–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã
4. **–ò–∑–æ–ª—è—Ü–∏—è** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Docker –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä –ø–æ—Ä—Ç–æ–≤

–ï—Å–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã, —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ:

| –°–µ—Ä–≤–∏—Å | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç | –ï—Å–ª–∏ –∑–∞–Ω—è—Ç |
|--------|------------------|------------|
| Backend | 8001 | 8002, 8003, ... |
| Frontend | 3001 | 3002, 3003, ... |
| MongoDB | 27017 | 27018, 27019, ... |
| HTTP | 80 | –ü—Ä–æ–ø—É—Å–∫ SSL |
| HTTPS | 443 | –ü—Ä–æ–ø—É—Å–∫ SSL |

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –°–∫–∞—á–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç

```bash
wget https://raw.githubusercontent.com/wrx861/market/main/deployment/install-existing-server.sh
chmod +x install-existing-server.sh
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É

```bash
sudo bash install-existing-server.sh
```

### –®–∞–≥ 3: –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ–¥–µ—Ç –≤–∞—Å —á–µ—Ä–µ–∑ 8 —à–∞–≥–æ–≤:

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤ (—Å –∞–≤—Ç–æ–ø–æ–¥–±–æ—Ä–æ–º)
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. ‚úÖ –í–≤–æ–¥ API –∫–ª—é—á–µ–π
4. ‚úÖ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
5. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
6. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ deployment
7. ‚úÖ SSL (–∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫ –µ—Å–ª–∏ –ø–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã)
8. ‚úÖ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üìä –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ—Ä—Ç—ã —Å–≤–æ–±–æ–¥–Ω—ã

```
‚úì –ü–æ—Ä—Ç 8001 —Å–≤–æ–±–æ–¥–µ–Ω (backend)
‚úì –ü–æ—Ä—Ç 3001 —Å–≤–æ–±–æ–¥–µ–Ω (frontend)
‚úì –ü–æ—Ä—Ç 27017 —Å–≤–æ–±–æ–¥–µ–Ω (MongoDB)
‚úì –ü–æ—Ä—Ç—ã 80/443 —Å–≤–æ–±–æ–¥–Ω—ã (SSL –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –ø–æ—Ä—Ç–∞–º–∏ + SSL

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã

```
‚ö† –ü–æ—Ä—Ç 8001 –∑–∞–Ω—è—Ç, –∏—â—É —Å–≤–æ–±–æ–¥–Ω—ã–π...
‚úì –ò—Å–ø–æ–ª—å–∑—É—é –ø–æ—Ä—Ç 8002 –¥–ª—è backend
‚úì –ü–æ—Ä—Ç 3001 —Å–≤–æ–±–æ–¥–µ–Ω (frontend)
‚úì –ü–æ—Ä—Ç 27017 —Å–≤–æ–±–æ–¥–µ–Ω (MongoDB)
‚úì –ü–æ—Ä—Ç—ã 80/443 —Å–≤–æ–±–æ–¥–Ω—ã (SSL –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Backend –Ω–∞ –ø–æ—Ä—Ç—É 8002, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ + SSL

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: HTTP/HTTPS –ø–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã (nginx/apache)

```
‚úì –ü–æ—Ä—Ç 8001 —Å–≤–æ–±–æ–¥–µ–Ω (backend)
‚úì –ü–æ—Ä—Ç 3001 —Å–≤–æ–±–æ–¥–µ–Ω (frontend)
‚úì –ü–æ—Ä—Ç 27017 —Å–≤–æ–±–æ–¥–µ–Ω (MongoDB)
‚ö† –ü–æ—Ä—Ç—ã 80/443 –∑–∞–Ω—è—Ç—ã (–≤–æ–∑–º–æ–∂–Ω–æ nginx/apache)
‚ö† SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 8001/3001, –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–∫—Å–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏ (–µ—Å–ª–∏ –ø–æ—Ä—Ç—ã 80/443 –∑–∞–Ω—è—Ç—ã)

### –î–ª—è Nginx

–î–æ–±–∞–≤—å—Ç–µ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```nginx
# Backend API
location /api/ {
    proxy_pass http://localhost:8001;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;
}

# Frontend
location / {
    proxy_pass http://localhost:3001;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;
}
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ nginx:
```bash
sudo nginx -t
sudo systemctl reload nginx
```

### –î–ª—è Apache

–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç:

```apache
<VirtualHost *:443>
    ServerName miniapp.shopmarketbot.ru
    
    # Backend API
    ProxyPass /api/ http://localhost:8001/api/
    ProxyPassReverse /api/ http://localhost:8001/api/
    
    # Frontend
    ProxyPass / http://localhost:3001/
    ProxyPassReverse / http://localhost:3001/
    
    SSLEngine on
    SSLCertificateFile /etc/letsencrypt/live/miniapp.shopmarketbot.ru/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/miniapp.shopmarketbot.ru/privkey.pem
</VirtualHost>
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ apache:
```bash
sudo a2enmod proxy proxy_http
sudo systemctl reload apache2
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∏–∑–æ–ª—è—Ü–∏—è

### Docker –∏–∑–æ–ª—è—Ü–∏—è

- ‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π Docker —Å–µ—Ç–∏
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑–≤–Ω–µ
- ‚úÖ –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞

### –ü–æ—Ä—Ç—ã

- ‚úÖ –¢–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞—Ä—É–∂—É
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä –∏—Å–∫–ª—é—á–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã
- ‚úÖ MongoDB –≤—Å–µ–≥–¥–∞ –≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏

## üìã –ß—Ç–æ –ù–ï –º–µ–Ω—è–µ—Ç—Å—è

–°–∫—Ä–∏–ø—Ç **–ù–ï** –∏–∑–º–µ–Ω—è–µ—Ç:

- ‚ùå –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã
- ‚ùå –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx/apache
- ‚ùå –î—Ä—É–≥–∏–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- ‚ùå –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚ùå Firewall –ø—Ä–∞–≤–∏–ª–∞ (–∫—Ä–æ–º–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è 80 –¥–ª—è certbot)

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
cd /opt/market-auto-parts
docker-compose ps
```

–û–∂–∏–¥–∞–µ—Ç—Å—è:
```
market-backend   Up
market-frontend  Up
market-mongodb   Up
market-nginx     Up
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤

```bash
sudo ss -tulpn | grep "8001\|3001\|27017"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
docker-compose logs --tail=50 backend
docker-compose logs --tail=50 frontend
```

## üÜò –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ü–æ—Ä—Ç—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, –∫–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å?

**A:** –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª—ã –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
cd /opt/market-auto-parts
nano backend/.env  # –æ–±–Ω–æ–≤–∏—Ç–µ REACT_APP_WEBAPP_URL –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
nano frontend/.env # –æ–±–Ω–æ–≤–∏—Ç–µ REACT_APP_BACKEND_URL –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
docker-compose down
docker-compose up -d
```

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–¥–¥–æ–º–µ–Ω?

**A:** –î–∞, –∑–∞–º–µ–Ω–∏—Ç–µ DOMAIN –≤ —Å–∫—Ä–∏–ø—Ç–µ:
```bash
# –í –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞ –∑–∞–º–µ–Ω–∏—Ç–µ:
DOMAIN="market.–≤–∞—à-–¥–æ–º–µ–Ω.ru"
```

### Q: –ß—Ç–æ –µ—Å–ª–∏ —É –º–µ–Ω—è —É–∂–µ –µ—Å—Ç—å MongoDB?

**A:** –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä MongoDB –Ω–∞ –¥—Ä—É–≥–æ–º –ø–æ—Ä—Ç—É. –û–Ω–∏ –Ω–µ –±—É–¥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å.

### Q: –ö–∞–∫ —É–¥–∞–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ?

**A:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ:
```bash
cd /opt/market-auto-parts
docker-compose down -v  # -v —É–¥–∞–ª–∏—Ç volumes —Å –¥–∞–Ω–Ω—ã–º–∏
cd ..
rm -rf /opt/market-auto-parts
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs --tail=100`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã: `sudo ss -tulpn`
3. –°–º–æ—Ç—Ä–∏—Ç–µ [DEPLOYMENT_README.md](DEPLOYMENT_README.md)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `docker-compose ps`

## üéâ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä –ø–æ—Ä—Ç–æ–≤
‚úÖ **–ò–∑–æ–ª—è—Ü–∏—è** - Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —Å–µ—Ä–≤–µ—Ä–∞
‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç –¥–µ–ª–∞–µ—Ç –≤—Å—ë

---

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –µ—Å–ª–∏ –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ —É–∂–µ —Ä–∞–±–æ—Ç–∞—é—Ç –¥—Ä—É–≥–∏–µ –ø—Ä–æ–µ–∫—Ç—ã. –î–ª—è —á–∏—Å—Ç—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `install-with-git.sh`.
