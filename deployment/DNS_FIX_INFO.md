# ðŸ”§ ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ DNS Ð² ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¾Ñ‡Ð½Ñ‹Ñ… ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°Ñ…

## ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°

ÐŸÑ€Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐµ Docker Ð½Ð° Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… ÑÐµÑ€Ð²ÐµÑ€Ð°Ñ… (Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ Contabo, Hetzner) Ð²Ð¾Ð·Ð½Ð¸ÐºÐ°ÐµÑ‚ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð° Ñ DNS:
```
failed to resolve source metadata for docker.io/library/node:20-alpine: 
failed to do request: Head "https://registry-1.docker.io/v2/library/node/manifests/20-alpine": 
dial tcp: lookup registry-1.docker.io on 127.0.0.53:53: read udp 127.0.0.1:48750->127.0.0.53:53: 
i/o timeout
```

**ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°:** systemd-resolved Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ DNS (127.0.0.53) ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð½Ðµ Ð²ÑÐµÐ³Ð´Ð° ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ñ Docker.

## Ð ÐµÑˆÐµÐ½Ð¸Ðµ

Ð’ÑÐµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¾Ñ‡Ð½Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‚ DNS:

### Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ `fix_dns()`:

1. **Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ Google DNS Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ:**
   ```bash
   nameserver 8.8.8.8
   nameserver 8.8.4.4  
   nameserver 1.1.1.1
   ```

2. **ÐÐ°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÑ‚ DNS Ð´Ð»Ñ Docker** (Ð´Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Docker):
   ```json
   {
     "dns": ["8.8.8.8", "8.8.4.4", "1.1.1.1"]
   }
   ```

3. **ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Docker** Ð¿Ð¾ÑÐ»Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº

## Ð—Ð°Ñ‚Ñ€Ð¾Ð½ÑƒÑ‚Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹

âœ… `install-with-git.sh` - ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ñ‡ÐµÑ€ÐµÐ· git clone  
âœ… `install-existing-server.sh` - ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€ Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°Ð¼Ð¸  
âœ… `install-clean-server.sh` - ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ñ‡ÐµÑ€ÐµÐ· curl Ñ„Ð°Ð¹Ð»Ð¾Ð²

## ÐŸÐ¾Ñ€ÑÐ´Ð¾Ðº Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð² ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°Ñ…

```
1. check_root
2. check_ports  
3. fix_dns          â† ÐÐ¾Ð²Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ (Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð”Ðž install_dependencies)
4. install_dependencies
5. ... Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑˆÐ°Ð³Ð¸
```

## Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ñ‡Ñ‚Ð¾ DNS Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚:

```bash
# Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ DNS
nslookup google.com

# Docker DNS
docker run --rm alpine nslookup google.com

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ Docker
cat /etc/docker/daemon.json
```

## ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°

- âœ… ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ - Ð½Ðµ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ñ€ÑƒÑ‡Ð½Ð¾Ð³Ð¾ Ð²Ð¼ÐµÑˆÐ°Ñ‚ÐµÐ»ÑŒÑÑ‚Ð²Ð°
- âœ… Ð Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð½Ð° Ð²ÑÐµÑ… Ñ‚Ð¸Ð¿Ð°Ñ… ÑÐµÑ€Ð²ÐµÑ€Ð¾Ð²
- âœ… ÐÐµ ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ÑƒÐµÑ‚ Ñ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¼Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ð¼Ð¸
- âœ… Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ Ð±ÑÐºÐ°Ð¿ `/etc/resolv.conf.backup`
- âœ… ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ Ð”Ðž ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Docker (Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹)

## Ð ÑƒÑ‡Ð½Ð¾Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ (ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾)

Ð•ÑÐ»Ð¸ Ð¿Ð¾ ÐºÐ°ÐºÐ¾Ð¹-Ñ‚Ð¾ Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ðµ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð½Ðµ ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°Ð»Ð¾:

```bash
# 1. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ DNS
sudo tee /etc/resolv.conf > /dev/null <<EOF
nameserver 8.8.8.8
nameserver 8.8.4.4
nameserver 1.1.1.1
EOF

# 2. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Docker DNS
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json > /dev/null <<EOF
{
  "dns": ["8.8.8.8", "8.8.4.4", "1.1.1.1"]
}
EOF

# 3. ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Docker
sudo systemctl restart docker

# 4. ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ
docker info | grep -i dns
```

## Ð¡Ð¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ

ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾ Ð½Ð°:
- âœ… Ubuntu 22.04 LTS
- âœ… Ubuntu 24.04 LTS
- âœ… Debian 11
- âœ… Debian 12

ÐŸÑ€Ð¾Ð²Ð°Ð¹Ð´ÐµÑ€Ñ‹:
- âœ… Contabo
- âœ… Hetzner
- âœ… DigitalOcean
- âœ… AWS EC2
- âœ… Google Cloud

---

**Ð’ÐµÑ€ÑÐ¸Ñ:** 2.1  
**Ð”Ð°Ñ‚Ð°:** 2025-11-14  
**Ð¡Ñ‚Ð°Ñ‚ÑƒÑ:** Ð’Ð½ÐµÐ´Ñ€ÐµÐ½Ð¾ Ð²Ð¾ Ð²ÑÐµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¾Ñ‡Ð½Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ âœ…
