# üöÄ Market Auto Parts - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ü–µ—Ä–≤–∏—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞](#–ø–µ—Ä–≤–∏—á–Ω–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å GitHub](#–∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ-—Å-github)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º)
- [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)

---

## üéØ –ü–µ—Ä–≤–∏—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å Git (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
wget https://raw.githubusercontent.com/–≤–∞—à-username/market/main/deployment/install-with-git.sh
chmod +x install-with-git.sh
sudo ./install-with-git.sh
```

–°–∫—Ä–∏–ø—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç:
- –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è
- API –∫–ª—é—á–∏ (Rossko, Autotrade, Berg, Google, Telegram)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

### –í–∞—Ä–∏–∞–Ω—Ç 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —á–∏—Å—Ç—ã–π —Å–µ—Ä–≤–µ—Ä

–ï—Å–ª–∏ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –µ—â–µ –Ω–µ—Ç:

```bash
wget https://raw.githubusercontent.com/–≤–∞—à-username/market/main/deployment/install-clean-server.sh
chmod +x install-clean-server.sh
sudo ./install-clean-server.sh
```

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–æ–∑–¥–∞–π—Ç–µ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
cd /opt/market-auto-parts
git init
git remote add origin https://github.com/–≤–∞—à-username/market.git
git add .
git commit -m "Initial commit"
git push -u origin main
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–µ—Ä–≤–µ—Ä

–ï—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —É–∂–µ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
wget https://raw.githubusercontent.com/–≤–∞—à-username/market/main/deployment/install-existing-server.sh
chmod +x install-existing-server.sh
sudo ./install-existing-server.sh
```

–°–∫—Ä–∏–ø—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ—Ä—Ç—ã –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.

---

## üîÑ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å GitHub

### –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤—ã —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ GitHub (`git push`):

```bash
cd /opt/market-auto-parts
bash deployment/update.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:**
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–¥ —Å GitHub
- ‚úÖ –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑—ã
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### –°–æ–∑–¥–∞–Ω–∏–µ –±—ã—Å—Ç—Ä–æ–π –∫–æ–º–∞–Ω–¥—ã

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–π—Ç–µ alias:

```bash
echo 'alias update-app="cd /opt/market-auto-parts && bash deployment/update.sh"' >> ~/.bashrc
source ~/.bashrc
```

–¢–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ:
```bash
update-app
```

### –ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

1. **–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ / Emergent:**
   ```bash
   git add .
   git commit -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
   git push origin main
   ```

2. **–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```bash
   cd /opt/market-auto-parts
   bash deployment/update.sh
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞:**
   ```bash
   docker-compose ps
   docker-compose logs -f backend
   ```

---

## üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
cd /opt/market-auto-parts/deployment

# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f                # –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose logs -f backend        # —Ç–æ–ª—å–∫–æ backend
docker-compose logs -f frontend       # —Ç–æ–ª—å–∫–æ frontend

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart                # –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose restart backend        # —Ç–æ–ª—å–∫–æ backend

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose down                   # –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ
docker-compose up -d                  # –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ

# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
docker-compose logs --tail=100 backend

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f backend

# –õ–æ–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –º–∏–Ω—É—Ç
docker-compose logs --since 10m backend

# –§–∏–ª—å—Ç—Ä –ø–æ —Å–ª–æ–≤—É
docker-compose logs backend | grep "ERROR"
```

### –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
# Backend
docker-compose exec backend bash

# Frontend
docker-compose exec frontend sh

# MongoDB
docker-compose exec mongodb mongosh
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ backend
curl https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/api/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ frontend
curl https://–≤–∞—à-–¥–æ–º–µ–Ω.ru

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose ps
```

---

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs backend

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª
cat /opt/market-auto-parts/backend/.env

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose down
docker-compose build --no-cache backend
docker-compose up -d backend
```

### Frontend –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs frontend

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
docker-compose exec frontend cat /etc/nginx/conf.d/default.conf

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ
docker-compose down
docker-compose build --no-cache frontend
docker-compose up -d frontend
```

### MongoDB –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ MongoDB –∑–∞–ø—É—â–µ–Ω
docker-compose ps mongodb

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs mongodb

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
docker-compose restart mongodb

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
docker-compose exec backend python -c "from pymongo import MongoClient; print(MongoClient('mongodb://mongodb:27017').server_info())"
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å SSL

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
sudo certbot certificates

# –û–±–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
sudo certbot renew

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx
docker-compose restart nginx
```

### –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ
df -h

# –û—á–∏—Å—Ç–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ Docker –æ–±—Ä–∞–∑—ã
docker system prune -a

# –û—á–∏—Å—Ç–∏—Ç–µ –ª–æ–≥–∏
sudo truncate -s 0 /var/log/nginx/*.log
sudo truncate -s 0 /var/log/supervisor/*.log
```

### –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏

```bash
cd /opt/market-auto-parts

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å—Ç–æ—Ä–∏—é
git log --oneline

# –û—Ç–∫–∞—Ç–∏—Ç–µ—Å—å –∫ –Ω—É–∂–Ω–æ–º—É –∫–æ–º–º–∏—Ç—É
git reset --hard <commit-hash>

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
bash deployment/update.sh
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# CPU –∏ –ø–∞–º—è—Ç—å
docker stats

# –ú–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
df -h

# –†–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker system df
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

```bash
crontab -e

# –î–æ–±–∞–≤—å—Ç–µ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é –Ω–æ—á—å –≤ 3:00)
0 3 * * * cd /opt/market-auto-parts && bash deployment/update.sh >> /var/log/market-update.log 2>&1
```

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# Backup MongoDB
docker-compose exec mongodb mongodump --out /backup
docker cp market-auto-parts-mongodb-1:/backup ./mongodb-backup-$(date +%Y%m%d)

# Backup .env —Ñ–∞–π–ª–æ–≤
tar -czf env-backup-$(date +%Y%m%d).tar.gz backend/.env frontend/.env

# Backup –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
tar -czf market-backup-$(date +%Y%m%d).tar.gz /opt/market-auto-parts
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é:** `deployment/UPDATE_INSTRUCTIONS.md`
- **–ö—Ä–∞—Ç–∫–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞:** `deployment/QUICK_UPDATE.md`
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker:** `deployment/docker-compose.yml`

---

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤: `docker-compose ps`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ: `df -h`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Docker –∑–∞–ø—É—â–µ–Ω: `systemctl status docker`

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
- Docker –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://docs.docker.com/
- Docker Compose: https://docs.docker.com/compose/
- Nginx: https://nginx.org/ru/docs/
- MongoDB: https://docs.mongodb.com/

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ù–æ—è–±—Ä—å 2024
